<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>gitGraph</title>
    <meta name="author" content="Sander Blue">

    <link href="css/morris.css" rel="stylesheet">

    <script type="text/javascript" src="js/vendor/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script type="text/javascript" src="js/vendor/morris.min.js"></script>
    <script type="text/javascript" src="js/vendor/moment.min.js"></script>

    <!--[if IE]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
      <link rel="stylesheet" href="css/ie.css">
    <![endif]-->
  </head>
<body>

<!-- <div id="test" style="height: 300px; width:660px;">Testing</div> -->


<script type="text/javascript">

  var testURL = 'http://www.sanderblue.com/datahost/gitGraph/twoweeks.json';
  var dataLocal = 'data/twoweeks.json'

  $.ajax({
    url: dataLocal,
    dataType: 'json',
    success: function (data) {

      var thisWeeksCommits = data.weeks[0].days;
      var lastWeeksCommits = data.weeks[1].days;
      var twoWeeksCommits = lastWeeksCommits.concat(thisWeeksCommits);
      var dayIndex = new Date().getDay();

      var thisWeeksDays = new Array(7);
          thisWeeksDays[0] = moment().utc().format('ddd');
          thisWeeksDays[1] = moment().utc().add('days', 6).format('ddd');
          thisWeeksDays[2] = moment().utc().add('days', 5).format('ddd');
          thisWeeksDays[3] = moment().utc().add('days', 4).format('ddd');
          thisWeeksDays[4] = moment().utc().add('days', 3).format('ddd');
          thisWeeksDays[5] = moment().utc().add('days', 2).format('ddd');
          thisWeeksDays[6] = moment().utc().add('days', 1).format('ddd');

      var thisWeekIndex = new Array(7);
          thisWeekIndex[0] = moment().utc().format('d');
          thisWeekIndex[1] = moment().utc().add('days', 1).format('d');
          thisWeekIndex[2] = moment().utc().add('days', 2).format('d');
          thisWeekIndex[3] = moment().utc().add('days', 3).format('d');
          thisWeekIndex[4] = moment().utc().add('days', 4).format('d');
          thisWeekIndex[5] = moment().utc().add('days', 5).format('d');
          thisWeekIndex[6] = moment().utc().add('days', 6).format('d');

      var lastWeekIndex = new Array(7);
          lastWeekIndex[0] = moment().utc().format('d');
          lastWeekIndex[1] = moment().utc().add('days', 1).format('d');
          lastWeekIndex[2] = moment().utc().add('days', 2).format('d');
          lastWeekIndex[3] = moment().utc().add('days', 3).format('d');
          lastWeekIndex[4] = moment().utc().add('days', 4).format('d');
          lastWeekIndex[5] = moment().utc().add('days', 5).format('d');
          lastWeekIndex[6] = moment().utc().add('days', 6).format('d');

      var twoWeeksIndices = lastWeekIndex.concat(thisWeekIndex);
      var commitsIndices = twoWeeksIndices.slice(dayIndex, dayIndex+7);
      var sevenDaysCommits = twoWeeksCommits.slice(dayIndex+1, dayIndex+8);


      var g = [];
      var commitsObj = { g : g }

      $.each(sevenDaysCommits, function (k, v) {
        g.push(v); // push new values to array g
      });

      console.log(commitsObj);
      // console.log(lastWeekIndex);
      console.log(twoWeeksCommits);
      console.log(twoWeeksIndices);
      console.log(commitsIndices);
      console.log(sevenDaysCommits);

      var day_data = [
        { "dayOfWeek": thisWeeksDays[0], "commits": commitsObj.g[6] },
        { "dayOfWeek": thisWeeksDays[1], "commits": commitsObj.g[5] },
        { "dayOfWeek": thisWeeksDays[2], "commits": commitsObj.g[4] },
        { "dayOfWeek": thisWeeksDays[3], "commits": commitsObj.g[3] },
        { "dayOfWeek": thisWeeksDays[4], "commits": commitsObj.g[2] },
        { "dayOfWeek": thisWeeksDays[5], "commits": commitsObj.g[1] },
        { "dayOfWeek": thisWeeksDays[6], "commits": commitsObj.g[0] }
      ];

      console.log(day_data);

    }
  });
</script>
</body>
</html>